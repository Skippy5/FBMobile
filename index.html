<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#4a69bd">
    <meta name="orientation" content="landscape">
    <title>Feedback King</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="game-container">
        <div class="header">
            <div class="mood-container">
                <span>Chappy's Mood:</span>
                <div class="mood-labels">
                    <span class="mood-label-left">Bye Bye RJ</span>
                    <span class="mood-label-right">Happy Chappy</span>
                </div>
                <div class="mood-bar-container">
                    <div id="mood-bar"></div>
                    <div id="mood-indicator"></div>
                </div>
                <span id="mood-value">4.0</span>
            </div>
            <div class="score-container">
                <div class="stats">
                    <span>Level: <span id="level">1</span></span>
                    <span>People Left: <span id="people-left">0</span></span>
                    <span>Score: <span id="score">0</span></span>
                    <span>Tokens: <span id="tokens">0</span></span>
                    <span>CSAT: <span id="csat-value">0.0</span></span>
                </div>
            </div>
        </div>
        
        <div class="game-area">
            <div id="buff-indicator" class="buff-indicator">Positive Feedback Buff: 0s</div>
            <canvas id="gameCanvas"></canvas>
            
            <!-- Mobile Controls -->
            <div class="mobile-controls">
                <div class="d-pad">
                    <button id="btn-up-left" class="btn-diagonal">‚Üñ</button>
                    <button id="btn-up" class="btn-direction">‚Üë</button>
                    <button id="btn-up-right" class="btn-diagonal">‚Üó</button>
                    <button id="btn-left" class="btn-direction">‚Üê</button>
                    <button id="btn-center" class="btn-direction"></button>
                    <button id="btn-right" class="btn-direction">‚Üí</button>
                    <button id="btn-down-left" class="btn-diagonal">‚Üô</button>
                    <button id="btn-down" class="btn-direction">‚Üì</button>
                    <button id="btn-down-right" class="btn-diagonal">‚Üò</button>
                </div>
            </div>
            <button id="btn-action" class="action-button">Interact</button>
        </div>
    </div>
    
    <!-- Orientation message for portrait mode -->
    <div id="orientation-message" class="orientation-message">
        <div class="orientation-content">
            <div class="phone-icon">üì±</div>
            <p>Please rotate your device to landscape mode</p>
            <div class="rotate-icon">‚Üª</div>
        </div>
    </div>
    
    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="game.js"></script>
    <script>
        // Force an immediate resize when the page loads
        window.addEventListener('load', function() {
            // Wait for game instance to be defined
            setTimeout(function() {
                if (typeof game !== 'undefined') {
                    game.resize();
                }
            }, 100);
            
            // Handle orientation changes
            window.addEventListener('orientationchange', function() {
                setTimeout(function() {
                    if (typeof game !== 'undefined') {
                        game.resize();
                    }
                }, 300);
            });
            
            // Also handle resize events
            window.addEventListener('resize', function() {
                setTimeout(function() {
                    if (typeof game !== 'undefined') {
                        game.resize();
                    }
                }, 100);
            });
        });
    </script>
</body>
</html>